{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574750381448_864725783","id":"20191126-063941_6590696","dateCreated":"2019-11-26T06:39:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:178","text":"%pyspark\n# spark Session object\nfrom pyspark.sql import SparkSession\nspark = SparkSession.builder.appName(\"yelp_analysis\").getOrCreate()","dateUpdated":"2019-11-26T06:50:46+0000","dateFinished":"2019-11-26T06:50:48+0000","dateStarted":"2019-11-26T06:50:46+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# loading the data from s3 bucket\nyelp_business = spark.read.csv('s3://yelpdataanalysis/yelp_business_medium.csv',header=True,inferSchema=True)\nyelp_review = spark.read.csv('s3://yelpdataanalysis/yelp_reviews.csv',header=True,inferSchema=True)","user":"anonymous","dateUpdated":"2019-11-26T06:52:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574751046242_-806708623","id":"20191126-065046_1919674117","dateCreated":"2019-11-26T06:50:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:697","dateFinished":"2019-11-26T06:52:20+0000","dateStarted":"2019-11-26T06:52:03+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# looking at the Schema\nprint(yelp_business.printSchema())\nprint(yelp_review.printSchema())","user":"anonymous","dateUpdated":"2019-11-26T06:52:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574751129265_714239997","id":"20191126-065209_1664947563","dateCreated":"2019-11-26T06:52:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:863","dateFinished":"2019-11-26T06:52:33+0000","dateStarted":"2019-11-26T06:52:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- address: string (nullable = true)\n |-- attributes: string (nullable = true)\n |-- business_id: string (nullable = true)\n |-- categories: string (nullable = true)\n |-- city: string (nullable = true)\n |-- hours: string (nullable = true)\n |-- is_open: string (nullable = true)\n |-- latitude: string (nullable = true)\n |-- longitude: string (nullable = true)\n |-- name: string (nullable = true)\n |-- postal_code: string (nullable = true)\n |-- review_count: string (nullable = true)\n |-- stars: string (nullable = true)\n |-- state: string (nullable = true)\n\nNone\nroot\n |-- business_id: string (nullable = true)\n |-- cool: string (nullable = true)\n |-- date: string (nullable = true)\n |-- funny: string (nullable = true)\n |-- review_id: string (nullable = true)\n |-- stars: string (nullable = true)\n |-- text: string (nullable = true)\n |-- useful: string (nullable = true)\n |-- user_id: string (nullable = true)\n\nNone\n"}]}},{"text":"%pyspark\n# now see top most reviewed business.\n# so take review data which has rating(stars) more than 3\n\nreview_star_three = yelp_review.filter('stars >3')\ngrouped_review = review_star_three.groupby('business_id').count()\nreview_sort = grouped_review.sort('count',ascending=False)\n\nbusiness_only = yelp_business.select('business_id','name','categories')\nreview_business_name = business_only.join(review_sort,'business_id','inner')\nTop_ten_reviewed_business = review_business_name.limit(15)\nprint('top most reviewed business')\nprint(Top_ten_reviewed_business.show())","user":"anonymous","dateUpdated":"2019-11-26T06:52:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574751123234_-1100057204","id":"20191126-065203_1501695398","dateCreated":"2019-11-26T06:52:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:782","dateFinished":"2019-11-26T06:53:03+0000","dateStarted":"2019-11-26T06:52:53+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"top most reviewed business\n+--------------------+--------------------+--------------------+-----+\n|         business_id|                name|          categories|count|\n+--------------------+--------------------+--------------------+-----+\n|-ElDqujEn1u64ynQr...| McFarling Law Group|Lawyers, Real Est...|    2|\n|09p3b5BCSz2FPvgR-...|Sammy's Service C...|Auto Repair, Gas ...|    2|\n|12ZCvo5eJShrpxwzv...|       Anna's Linens|Shopping, Arts & ...|    1|\n|2qjardgA7iqYsuAs0...|AT&T Authorized R...|IT Services & Com...|    1|\n|4WVNsBfTtCzfQhCOD...|PartyZams Singing...|Musicians, Event ...|    2|\n|4v6e_afy2uAiQYDq9...|Dentistry At Gree...|Health & Medical,...|    2|\n|ASXvXm-_-Tm37diPm...|     Zak's Bike Shop|Hiking, Shopping,...|    3|\n|FcRf8dciFsQ9ZUj0B...|    Janicek Mike, MD|Health & Medical,...|    2|\n|I3G2JYu61LSCZDs4C...|A Gentle Smile De...|Periodontists, De...|    1|\n|Nm-9cOSh9SLT2e4qc...|Accredited Home I...|Home Inspectors, ...|    3|\n|R4k7r7XHRavbGGJHN...| Formula One Imports|Auto Customizatio...|    1|\n|RxtaiNM8wK2U924dq...|Rolle Oral & Faci...|Cosmetic Dentists...|    1|\n|TdefcbsFAj6WXHwlG...|Toy Town Play Center|Playgrounds, Amus...|    2|\n|WyNlF7TMW7lNIta0j...|      The Spoke Easy|Local Services, B...|    2|\n|a1TTRvtMCDoxalOU6...|Cabano's Comfort ...|Burgers, Comfort ...|    2|\n+--------------------+--------------------+--------------------+-----+\n\nNone\n"}]}},{"text":"%pyspark\n#Top 10 category which has most business count\n\nfrom pyspark.sql.functions import split,explode\n\ncategory = yelp_business.select('categories')\nindividual_category = category.select(explode(split('categories', ',')).alias('category'))\ngrouped_category = individual_category.groupby('category').count()\ntop_category = grouped_category.sort('count',ascending=False)\nprint('Top 10 category which has most business count')\nprint(top_category.show(10,truncate=False))","user":"anonymous","dateUpdated":"2019-11-26T06:53:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574751173342_1330007059","id":"20191126-065253_2031791154","dateCreated":"2019-11-26T06:52:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:966","dateFinished":"2019-11-26T06:53:09+0000","dateStarted":"2019-11-26T06:53:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top 10 category which has most business count\n+----------------------+-----+\n|category              |count|\n+----------------------+-----+\n| 'validated': False   |30162|\n| Home Services        |6685 |\n| Health & Medical     |4815 |\n| Automotive           |4196 |\n| Local Services       |3763 |\n| Shopping             |3291 |\n|Home Services         |2645 |\n| Auto Repair          |2224 |\n| Professional Services|2178 |\n| 'classy': False      |2168 |\n+----------------------+-----+\nonly showing top 10 rows\n\nNone\n"}]}},{"text":"%pyspark\n#Top Rating give by User to business\n\nrating = yelp_business.select('stars')\ngroup_rating = rating.groupby('stars').count()\nrating_top = group_rating.sort('count',ascending=False)\nprint('Top Rating give by User to business')\nprint(rating_top.show(5))","user":"anonymous","dateUpdated":"2019-11-26T06:53:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574751187776_-1601499235","id":"20191126-065307_1993646757","dateCreated":"2019-11-26T06:53:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1065","dateFinished":"2019-11-26T06:53:16+0000","dateStarted":"2019-11-26T06:53:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top Rating give by User to business\n+-----+-----+\n|stars|count|\n+-----+-----+\n|  5.0| 9665|\n|  3.5| 6002|\n|  4.0| 5680|\n|  4.5| 5528|\n|    1| 4609|\n+-----+-----+\nonly showing top 5 rows\n\nNone\n"}]}},{"text":"%pyspark\n# Top Locations who have number of business more in world\n\nlocations = yelp_business.select('business_id','city')\nreview_city = yelp_review.select('business_id')\nmerge_city = locations.join(review_city,'business_id','inner')\ngrouped_review_city = merge_city.groupby('city').count()\nmost_reviewed_city = grouped_review_city.groupby('city').sum()\nprint('Top Locations who have number of business more in world')\nprint(most_reviewed_city.sort('sum(count)',ascending=False).show(10))","user":"anonymous","dateUpdated":"2019-11-26T06:53:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574751194493_-253847373","id":"20191126-065314_1894701475","dateCreated":"2019-11-26T06:53:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1164","dateFinished":"2019-11-26T06:53:25+0000","dateStarted":"2019-11-26T06:53:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top Locations who have number of business more in world\n+----------+----------+\n|      city|sum(count)|\n+----------+----------+\n| Las Vegas|      9761|\n|   Phoenix|      4546|\n|Scottsdale|      1723|\n|      Mesa|      1623|\n| Henderson|      1462|\n|   Gilbert|      1118|\n|   Toronto|      1107|\n|     Tempe|      1052|\n| Charlotte|       992|\n|  Chandler|       924|\n+----------+----------+\nonly showing top 10 rows\n\nNone\n"}]}},{"text":"%pyspark\n\nmost_reviewed_city.sort('sum(count)',ascending=False).write.save(\"s3://yelpdataanalysis/yelp_insights/top_locations_who_have_number_of_bussiness.csv\", format='csv', header=True)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-11-26T07:10:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574751263250_-104560706","id":"20191126-065423_553207931","dateCreated":"2019-11-26T06:54:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1362","dateFinished":"2019-11-26T07:11:00+0000","dateStarted":"2019-11-26T07:10:48+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nTop_ten_reviewed_business.select('name','categories','count').limit(10).write.save(\"s3://yelpdataanalysis/yelp_insights/top_reviewed_bussiness.csv\", format='csv', header=True)\n","user":"anonymous","dateUpdated":"2019-11-26T07:10:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574752192954_-1015621936","id":"20191126-070952_1160335829","dateCreated":"2019-11-26T07:09:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1787","dateFinished":"2019-11-26T07:11:08+0000","dateStarted":"2019-11-26T07:10:53+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nrating_top.write.save(\"s3://yelpdataanalysis/yelp_insights/top_ratings_given_by_user.csv\", format='csv', header=True)\n","user":"anonymous","dateUpdated":"2019-11-26T07:10:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574752192444_531790394","id":"20191126-070952_1731687345","dateCreated":"2019-11-26T07:09:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1715","dateFinished":"2019-11-26T07:11:10+0000","dateStarted":"2019-11-26T07:11:01+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ntop_category.write.save(\"s3://yelpdataanalysis/yelp_insights/top_categories.csv\", format='csv', header=True)\n","user":"anonymous","dateUpdated":"2019-11-26T07:10:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574752191884_1956150830","id":"20191126-070951_1887940999","dateCreated":"2019-11-26T07:09:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1643","dateFinished":"2019-11-26T07:11:12+0000","dateStarted":"2019-11-26T07:11:08+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-11-26T07:10:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574752256199_457410390","id":"20191126-071056_31924343","dateCreated":"2019-11-26T07:10:56+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1913"}],"name":"yelp_data_exploration","id":"2EVYKX2X4","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}